<form class="{{cssClass}} v-sheet" autocomplete="off">

  <!-- ===== Header ===== -->
  <header class="v-header">
    <div class="v-header__title">
      <h1 class="v-name">{{actor.name}}</h1>
      <div class="v-subtle">Vitruvium · лист персонажа</div>
    </div>
    <div class="v-header__rule">
      <span class="v-rule">1–3 = 0 · 4–5 = 1 · 6 = 2</span>
    </div>
  </header>

  <div class="v-grid">

    <!-- ===== Left: Attributes ===== -->
    <section class="v-panel">
      <div class="v-panel__head">
        <h2 class="v-h2">Атрибуты</h2>
        <div class="v-line"></div>
      </div>

      <div class="v-attrs">
        {{#each vitruvium.attributes as |a|}}
          <div class="v-attr">
            <div class="v-attr__left">
              <div class="v-attr__label">{{a.label}}</div>
              <div class="v-attr__controls">
                <button
                  type="button"
                  class="v-btn v-btn--tiny"
                  data-action="attr-dec"
                  data-attr="{{a.key}}"
                  aria-label="Уменьшить"
                >−</button>
                <div class="v-attr__value">{{a.value}}</div>
                <button
                  type="button"
                  class="v-btn v-btn--tiny"
                  data-action="attr-inc"
                  data-attr="{{a.key}}"
                  aria-label="Увеличить"
                >+</button>
              </div>
            </div>

            <button
              type="button"
              class="v-btn v-btn--ghost"
              data-action="roll-attribute"
              data-attr="{{a.key}}"
              data-label="{{a.label}}"
            >
              Бросить
            </button>
          </div>
        {{/each}}
      </div>
    </section>

    <!-- ===== Right: Resources + Quick Roll ===== -->
    <section class="v-panel">
      <div class="v-panel__head">
        <h2 class="v-h2">Ресурсы</h2>
        <div class="v-line"></div>
      </div>

      <!-- HP -->
      <div class="v-resource">
        <div class="v-resource__top">
          <div class="v-resource__label">HP</div>
          <div class="v-resource__hint">Макс. = 5 × Самочувствие</div>
        </div>

        <div class="v-resource__row">
          <input
            class="v-input v-input--hp"
            type="number"
            name="system.attributes.hp.value"
            value="{{vitruvium.hp.value}}"
            data-dtype="Number"
            min="0"
          />
          <span class="v-sep">/</span>
          <span class="v-readonly">{{vitruvium.hp.max}}</span>
        </div>
      </div>

      <!-- Inspiration -->
      <div class="v-resource">
        <div class="v-resource__top">
          <div class="v-resource__label">Вдохновение</div>
          <div class="v-resource__hint">Тратить на способности</div>
        </div>

        <div class="v-resource__row">
          <button
            type="button"
            class="v-btn v-btn--tiny"
            data-action="insp-dec"
            aria-label="Потратить"
          >−</button>
          <span class="v-readonly">{{vitruvium.inspiration.value}}</span>
          <span class="v-sep">/</span>
          <span class="v-readonly">{{vitruvium.inspiration.max}}</span>
          <button
            type="button"
            class="v-btn v-btn--tiny"
            data-action="insp-inc"
            aria-label="Восстановить"
          >+</button>
        </div>
      </div>

      <!-- Extra dice -->
      <div class="v-panel__head" style="margin-top: 8px;">
        <h2 class="v-h2">Доп. бросок</h2>
        <div class="v-line"></div>
      </div>

      <div class="v-extra">
        <button
          type="button"
          class="v-btn v-btn--tiny"
          data-action="extra-dec"
          aria-label="Меньше"
        >−</button>
        <span class="v-readonly v-readonly--big">{{vitruvium.extraDice}}</span>
        <button
          type="button"
          class="v-btn v-btn--tiny"
          data-action="extra-inc"
          aria-label="Больше"
        >+</button>

        <button
          type="button"
          class="v-btn v-btn--solid"
          data-action="extra-roll"
        >
          Бросить
        </button>
      </div>

      <div class="v-luck">
        <button
          type="button"
          class="v-btn v-btn--ghost"
          data-action="luck-roll"
        >
          Бросок удачи
        </button>
      </div>

      <div class="v-subtle" style="margin-top: 6px;">
        Для “докинь ещё X кубов” без привязки к атрибуту.
      </div>

    </section>

    <!-- ===== Full width: Abilities ===== -->
    <section class="v-panel v-panel--wide">
      <div class="v-panel__head">
        <h2 class="v-h2">Способности</h2>
        <div class="v-line"></div>

        <button
          type="button"
          class="v-btn v-btn--ghost"
          data-action="create-ability"
        >
          + Новая
        </button>
      </div>

      <div class="v-abilities">
        {{#each actor.items as |it|}}
          {{#if (eq it.type "ability")}}
            <div class="v-ability">
              <div class="v-ability__main">
                <div class="v-ability__name">{{it.name}}</div>
                <div class="v-ability__meta">Стоимость:
                  <b>{{it.system.cost}}</b>
                  вдохн.</div>
              </div>

              <div class="v-ability__btns">
                <button
                  type="button"
                  class="v-btn v-btn--solid"
                  data-action="use-ability"
                  data-item-id="{{it._id}}"
                >Применить</button>
                <button
                  type="button"
                  class="v-btn v-btn--ghost"
                  data-action="edit-item"
                  data-item-id="{{it._id}}"
                >Открыть</button>
                <button
                  type="button"
                  class="v-btn v-btn--danger"
                  data-action="delete-item"
                  data-item-id="{{it._id}}"
                >Удалить</button>
              </div>
            </div>
          {{/if}}
        {{/each}}
      </div>

      <div class="v-subtle" style="margin-top: 8px;">
        Способности — нарративные инструменты. Применение списывает вдохновение
        и пишет карточку в чат.
      </div>

    </section>

  </div>
</form>